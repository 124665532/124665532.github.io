<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    

    <title>
      用Unity3d做一个人物运动 | ~糖果先生的干货 
    </title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    
      <meta name="author" content="Mirza Zhao">
    
    

    <meta name="description" content="一、前期准备1.C#IDE的安装（我使用的是VS2010）2.Unity3d 4.6.0安装和破解安装包下载地址：http://www.cgjoy.com/thread-103460-1-1.html
3.U3d配置打开破解好的unity3d，点Edit选项卡，选择Preferences…找到External Tools，    会看到External Script Editor是Monodev">
<meta property="og:type" content="article">
<meta property="og:title" content="用Unity3d做一个人物运动 | ~糖果先生的干货">
<meta property="og:url" content="http://yoursite.com/2016/10/29/用Unity3d做一个人物运动/index.html">
<meta property="og:site_name" content="~糖果先生的干货">
<meta property="og:description" content="一、前期准备1.C#IDE的安装（我使用的是VS2010）2.Unity3d 4.6.0安装和破解安装包下载地址：http://www.cgjoy.com/thread-103460-1-1.html
3.U3d配置打开破解好的unity3d，点Edit选项卡，选择Preferences…找到External Tools，    会看到External Script Editor是Monodev">
<meta property="og:image" content="http://a2.qpic.cn/psb?/V10ENCWC0EABA1/CUDqp66AtY7EgoYKySZQR5LIEOuyGfQjWOYAdcKlapc!/b/dLIAAAAAAAAA&bo=3wJ9AgAAAAADAIc!&rf=viewer_4">
<meta property="og:image" content="http://a1.qpic.cn/psb?/V10ENCWC0EABA1/MaZ4EdjF8AOAa3ehQKnZe6TvFM.VqXNoUYipLQIbyo8!/b/dPYAAAAAAAAA&bo=uwIHAQAAAAADB50!&rf=viewer_4">
<meta property="og:image" content="http://a2.qpic.cn/psb?/V10ENCWC0EABA1/VK.2E*CpUOdo4uU7QFP07.P*8tx75JgeZuaETOYcyGw!/b/dLIAAAAAAAAA&bo=PgHBAAAAAAADANs!&rf=viewer_4">
<meta property="og:image" content="http://a1.qpic.cn/psb?/V10ENCWC0EABA1/MaZ4EdjF8AOAa3ehQKnZe6TvFM.VqXNoUYipLQIbyo8!/b/dPYAAAAAAAAA&bo=uwIHAQAAAAADB50!&rf=viewer_4">
<meta property="og:updated_time" content="2016-10-30T05:25:05.613Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="用Unity3d做一个人物运动 | ~糖果先生的干货">
<meta name="twitter:description" content="一、前期准备1.C#IDE的安装（我使用的是VS2010）2.Unity3d 4.6.0安装和破解安装包下载地址：http://www.cgjoy.com/thread-103460-1-1.html
3.U3d配置打开破解好的unity3d，点Edit选项卡，选择Preferences…找到External Tools，    会看到External Script Editor是Monodev">
<meta name="twitter:image" content="http://a2.qpic.cn/psb?/V10ENCWC0EABA1/CUDqp66AtY7EgoYKySZQR5LIEOuyGfQjWOYAdcKlapc!/b/dLIAAAAAAAAA&bo=3wJ9AgAAAAADAIc!&rf=viewer_4">
    
    
    
      <link rel="icon" type="image/x-icon" href="/favicon.png">
    
    <link rel="stylesheet" href="/css/uno.css">
    <link rel="stylesheet" href="/css/highlight.css">
    <link rel="stylesheet" href="/css/archive.css">
    <link rel="stylesheet" href="/css/china-social-icon.css">

</head>
<body>

    <span class="mobile btn-mobile-menu">
        <i class="icon icon-list btn-mobile-menu__icon"></i>
        <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

    

<header class="panel-cover panel-cover--collapsed">


  <div class="panel-main">

  
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        

        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage">~糖果先生的干货</a></h1>
        <hr class="panel-cover__divider" />

        
        <p class="panel-cover__description">
          Welcome to Mirza&#39;s Blog!!
        </p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />
        

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">

              
                
                <li class="navigation__item"><a href="/#blog" title="" class="blog-button">首页</a></li>
              
                
                <li class="navigation__item"><a href="/about" title="" class="">关于</a></li>
              
                
                <li class="navigation__item"><a href="/archive" title="" class="">归档</a></li>
              

            </ul>
          </nav>

          <!-- ----------------------------
To add a new social icon simply duplicate one of the list items from below
and change the class in the <i> tag to match the desired social network
and then add your link to the <a>. Here is a full list of social network
classes that you can use:

    icon-social-500px
    icon-social-behance
    icon-social-delicious
    icon-social-designer-news
    icon-social-deviant-art
    icon-social-digg
    icon-social-dribbble
    icon-social-facebook
    icon-social-flickr
    icon-social-forrst
    icon-social-foursquare
    icon-social-github
    icon-social-google-plus
    icon-social-hi5
    icon-social-instagram
    icon-social-lastfm
    icon-social-linkedin
    icon-social-medium
    icon-social-myspace
    icon-social-path
    icon-social-pinterest
    icon-social-rdio
    icon-social-reddit
    icon-social-skype
    icon-social-spotify
    icon-social-stack-overflow
    icon-social-steam
    icon-social-stumbleupon
    icon-social-treehouse
    icon-social-tumblr
    icon-social-twitter
    icon-social-vimeo
    icon-social-xbox
    icon-social-yelp
    icon-social-youtube
    icon-social-zerply
    icon-mail

-------------------------------->

<!-- add social info here -->



        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner entry">
            

<article class="post-container post-container--single">

  <header class="post-header">
    
    <h1 class="post-title">用Unity3d做一个人物运动</h1>

    

    <div class="post-meta">
      <time datetime="2016-10-29" class="post-meta__date date">2016-10-29</time> 

      <span class="post-meta__tags tags">

          

          
             &#8226; 标签:
            <font class="tags">
              <a class="tags-link" href="/tags/C/">C#</a>, <a class="tags-link" href="/tags/Unity3d/">Unity3d</a>
            </font>
          

      </span>
    </div>
    
    

  </header>

  <section id="post-content" class="article-content post">
    <p><img src="http://a2.qpic.cn/psb?/V10ENCWC0EABA1/CUDqp66AtY7EgoYKySZQR5LIEOuyGfQjWOYAdcKlapc!/b/dLIAAAAAAAAA&amp;bo=3wJ9AgAAAAADAIc!&amp;rf=viewer_4" alt="游戏"></p>
<h1 id="一、前期准备"><a href="#一、前期准备" class="headerlink" title="一、前期准备"></a>一、前期准备</h1><h2 id="1-C-IDE的安装（我使用的是VS2010）"><a href="#1-C-IDE的安装（我使用的是VS2010）" class="headerlink" title="1.C#IDE的安装（我使用的是VS2010）"></a>1.C#IDE的安装（我使用的是VS2010）</h2><h2 id="2-Unity3d-4-6-0安装和破解"><a href="#2-Unity3d-4-6-0安装和破解" class="headerlink" title="2.Unity3d 4.6.0安装和破解"></a>2.Unity3d 4.6.0安装和破解</h2><p>安装包下载地址：<br><a href="http://www.cgjoy.com/thread-103460-1-1.html" target="_blank" rel="external">http://www.cgjoy.com/thread-103460-1-1.html</a></p>
<h2 id="3-U3d配置"><a href="#3-U3d配置" class="headerlink" title="3.U3d配置"></a>3.U3d配置</h2><p>打开破解好的unity3d，点Edit选项卡，选择Preferences…找到External Tools，    会看到External Script Editor是Monodevelop，点Browser选择自己喜欢的Editor。</p>
<a id="more"></a>
<h1 id="二、使用现有的包做一个人物运动游戏"><a href="#二、使用现有的包做一个人物运动游戏" class="headerlink" title="二、使用现有的包做一个人物运动游戏"></a>二、使用现有的包做一个人物运动游戏</h1><h2 id="一、打开资源包practice-unitypackage"><a href="#一、打开资源包practice-unitypackage" class="headerlink" title="一、打开资源包practice.unitypackage"></a>一、打开资源包practice.unitypackage</h2><p>1.方法一：双击打开包<br>2.方法二：到unity里面选择Assets选项卡，点选import package -&gt;custom package…  然后选中下载的资源包。</p>
<h2 id="二、开始写Player的C-代码"><a href="#二、开始写Player的C-代码" class="headerlink" title="二、开始写Player的C#代码"></a>二、开始写Player的C#代码</h2><h3 id="1-新建一个C-文件（-cs）"><a href="#1-新建一个C-文件（-cs）" class="headerlink" title="1.新建一个C#文件（.cs）"></a>1.新建一个C#文件（.cs）</h3><p>文件名要和物体一样（区分大小写），再将文件挂到物体上，将其相关。</p>
<h3 id="2-再者写下以下代码："><a href="#2-再者写下以下代码：" class="headerlink" title="2.再者写下以下代码："></a>2.再者写下以下代码：</h3><pre><code>using UnityEngine;
using System.Collections;
public class Player : MonoBehaviour {
    public float walkSpeed;
    // Use this for initialization
    void Start () {
        walkSpeed = 5.0f;
    }
    // Update is called once per frame
    void Update () {
        //transform.position += walkSpeed * Time.deltaTime * transform.forward;
        Vector3 direction = Input.GetAxis(&quot;Horizontal&quot;) * transform.right + 
                        Input.GetAxis(&quot;Vertical&quot;) * transform.forward;
        transform.position += walkSpeed * Time.deltaTime * direction;

    }
}
</code></pre><h2 id="三、让游戏人物动起来！"><a href="#三、让游戏人物动起来！" class="headerlink" title="三、让游戏人物动起来！"></a>三、让游戏人物动起来！</h2><h3 id="1-创建一个animator（动画片制作者）的C-文件"><a href="#1-创建一个animator（动画片制作者）的C-文件" class="headerlink" title="1.创建一个animator（动画片制作者）的C#文件"></a>1.创建一个animator（动画片制作者）的C#文件</h3><h3 id="2-并加入以下代码："><a href="#2-并加入以下代码：" class="headerlink" title="2.并加入以下代码："></a>2.并加入以下代码：</h3><pre><code>using UnityEngine;
using System.Collections;
public class player_animator : MonoBehaviour {
    public Animator animator;
    private Vector3 lastPosition;
    private float Speed;
    private float Angle;
    // Use this for initialization
    void Start () {
        lastPosition = transform.position;
    }
    // Update is called once per frame
    void Update () {
        Vector3 Velocity = (transform.position - lastPosition) / Time.deltaTime;
        Vector3 localVelocity = transform.InverseTransformDirection(Velocity);
        localVelocity.y = 0;
        Speed = localVelocity.magnitude;
        animator.SetFloat(&quot;Speed&quot;, Speed);
        Angle = (HorizontalAngle(localVelocity) + 360f) % 360;
        animator.SetFloat(&quot;Angle&quot;, Angle);
        lastPosition = transform.position;
    }
    float HorizontalAngle(Vector3 localVelocity)
    {
        float angle = Mathf.Atan2(localVelocity.z, localVelocity.x) * Mathf.Rad2Deg;
        return angle;
    }
}
</code></pre><h3 id="3-设置Animator如图"><a href="#3-设置Animator如图" class="headerlink" title="3. 设置Animator如图"></a>3. 设置Animator如图</h3><p><img src="http://a1.qpic.cn/psb?/V10ENCWC0EABA1/MaZ4EdjF8AOAa3ehQKnZe6TvFM.VqXNoUYipLQIbyo8!/b/dPYAAAAAAAAA&amp;bo=uwIHAQAAAAADB50!&amp;rf=viewer_4" alt="animator"><br>并且加入Angle和Speed 2个Parameter以及相关的动画来调整人物的动作。<br><img src="http://a2.qpic.cn/psb?/V10ENCWC0EABA1/VK.2E*CpUOdo4uU7QFP07.P*8tx75JgeZuaETOYcyGw!/b/dLIAAAAAAAAA&amp;bo=PgHBAAAAAAADANs!&amp;rf=viewer_4" alt=""><br>还有就是物体的Apply Root Motion不能打勾，不然会应用动画位移。</p>
<h1 id="三、遇到的问题及其解决方法"><a href="#三、遇到的问题及其解决方法" class="headerlink" title="三、遇到的问题及其解决方法"></a>三、遇到的问题及其解决方法</h1><h2 id="1-人物会在天上飞？？"><a href="#1-人物会在天上飞？？" class="headerlink" title="1.人物会在天上飞？？"></a>1.人物会在天上飞？？</h2><p>百度了一下知道在rigidbody里面有个重力的选择，打上勾就可以有重力了。</p>
<h2 id="2-人物陷入地底下？？"><a href="#2-人物陷入地底下？？" class="headerlink" title="2.人物陷入地底下？？"></a>2.人物陷入地底下？？</h2><p>在加入了重力之后，人物虽然不会飞上天了，但是会掉到地底下。这个问题也是困扰我    最久的问题。经过长时间的各种度娘，最后找到一个比较满意的结果。网上说陷入底下    是因为没有碰撞的原因，所以人物应该做成刚体也就是有rigidbody元素，同样地板    也要是一个边界才行，并且“is Trigger”这一项不能打勾，不然仍然会穿过去。经过    一番折腾，我给地板加了边界Terrain Collider，并且人物也设置成胶囊刚体。但是但    是但是！！我还是掉下去了！旁边做的一个滑稽箱子却稳稳的立在地上。至于问题还有    待研究。最终我做出的决定是将地板做出一个高度为0的盒子模型，并设置刚体。然    后就成功的站在地板上了。虽然走起路来有点奇怪。。。</p>
<h3 id="3-人物动作变更诡异"><a href="#3-人物动作变更诡异" class="headerlink" title="3.人物动作变更诡异"></a>3.人物动作变更诡异</h3><p>当人物往一个方向走的时候再按其他方向键，即使角度改变也没有做出相应动作。研究了一下Animator发现是因为动作的改变都是基于站立状态的，而并没有从动作-&gt;动作的关联，因此会很鬼畜。所以最蠢（也是我唯一能想到的）的办法就是在所有状态都做一个关联，这样就稍微自然一点了。（向后动作的关联略，如下图）<br><img src="http://a1.qpic.cn/psb?/V10ENCWC0EABA1/MaZ4EdjF8AOAa3ehQKnZe6TvFM.VqXNoUYipLQIbyo8!/b/dPYAAAAAAAAA&amp;bo=uwIHAQAAAAADB50!&amp;rf=viewer_4" alt="animator"></p>
<h1 id="四、小结"><a href="#四、小结" class="headerlink" title="四、小结"></a>四、小结</h1><p>这次培训的是U3d的了解，虽然说如果以后不从事游戏开发，可能一辈子都用不上这个。不过这个一直是我的兴趣，很早之前就想自己做游戏玩。这次这个人物运动的小任务总的来说还凑合。子弹部分的代码没有跟上所以没做出来，这个蛮遗憾的。不过收获的是第一次感受到游戏开发是一种什么样的体验。最后想说的是，做游戏没有强大的美工真的不行呀！！！我们这种程序猿在这方面只能做伸手党了！</p>

  </section>

  
  

<section class="post-comments">

    <div class="ds-thread" data-thread-key="2016/10/29/用Unity3d做一个人物运动/"></div>

    <script type="text/javascript">
      var duoshuoQuery = {short_name:"124665532"};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
        || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
    </script> 

</section>


</article>


            <footer class="footer">

    <span class="footer__copyright">&copy; 2014-2015. | 由<a href="https://hexo.io/">Hexo</a>强力驱动 | 主题<a href="https://github.com/someus/huno">Huno</a></span>
    
</footer>
        </div>
    </div>

    <!-- js files -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/scale.fix.js"></script>
    

    

    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript"> 
        $(document).ready(function(){
            MathJax.Hub.Config({ 
                tex2jax: {inlineMath: [['[latex]','[/latex]'], ['\\(','\\)']]} 
            });
        });
    </script>


    

    <script src="/js/awesome-toc.min.js"></script>
    <script>
        $(document).ready(function(){
            $.awesome_toc({
                overlay: true,
                contentId: "post-content",
            });
        });
    </script>


    
    
    <!--kill ie6 -->
<!--[if IE 6]>
  <script src="//letskillie6.googlecode.com/svn/trunk/2/zh_CN.js"></script>
<![endif]-->

</body>
</html>
